{"headers":[{"key":"pos","value":true,"style":"boolean"},{"key":"mode","value":1,"style":"number"}],"items":[{"key":"pts","value":0,"style":"number","css":"o"},{"key":"x","value":0,"style":"number","css":"x","repeatChar":"×"}],"priority":[{"key":"status","order":"desc","alter":["win",2,"lose",0,1]},{"key":"pts","order":"desc"}],"actions":[{"name":"○","css":"action_o","button_css":"btn btn-primary btn-lg","keyArray":"k1","tweet":"o","enable0":"return (player.status == 'normal' && !header.playoff);","action0":"switch (header.mode) {\n  case 1:\n    // ptsを加算\n    player.pts++;\n    setMotion(player, 'o');\n    addQCount(players, header, property);\n    break;\n  case 2:\n  case 3:\n    // 他のプレイヤーのptsを減算\n    players.filter(function(p) {\n      return p != player && p.status == \"normal\";\n    }).map(function(p) {\n      p.pts--;\n    });\n    setMotion(player, 'o');\n    addQCount(players, header, property);\n    // ×を消す\n    players.map(function(p){\n       p.x = 0; \n    });\n    break;\n}"},{"name":"×","css":"action_x","button_css":"btn btn-danger btn-lg","keyArray":"k2","tweet":"x","enable0":"return (player.status == 'normal' && !header.playoff);","action0":"switch (header.mode) {\n  case 1:\n    // 他のプレイヤーのptsを加算\n    players.filter(function(p) {\n      return p != player && p.status == \"normal\";\n    }).map(function(p) {\n      p.pts++;\n    });\n    setMotion(player, 'x');\n    addQCount(players, header, property);\n    break;\n  case 2:\n    // 自分のptsを減算\n    player.pts--;\n    setMotion(player, 'x');\n    addQCount(players, header, property);\n    break;\n  case 3:\n    // 自分に×をつける\n    player.x = 1;\n    setMotion(player, 'x');\n    // 問題は進めない\n    break;\n}"}],"global_actions":[{"name":"thru","button_css":"btn btn-default","group":"rule","keyboard":"Space","tweet":"thru","enable0":"return true;","action0":"addQCount(players, header, property);\n// ×を解除\nplayers.map(function(p){\n   p.x = 0; \n});\n"},{"name":"pos","button_css":"btn btn-default","group":"rule","enable0":"return true;","action0":"header.pos = !header.pos;","keyArray":""}],"global_actions_repeat":[],"tweet":{"o":"${handleName}◯　→${pts}p ${score}","x":"${handleName}×　→${pts}p ${score}","thru":"スルー"},"judgement":"angular.forEach(players.filter(function(item) {\n  /* rankがない人に限定 */\n  return (item.rank === 0);\n}), function(player, i) {\n  /* win条件*/\n  if (player.pts >= 1 && header.mode >= 2 &&\n    players.filter(function(p) {\n      return p.pts >= 1 && p != player;\n    }).length === 0) {\n    win(player, players, header, property);\n  }\n  /* lose条件 */\n  if (player.pts <= 0 && header.mode >= 2) {\n    lose(player, players, header, property);\n  }\n});","calc":"// modeName\nif (header.mode == 1) {\n  header.modeName = \"前半\";\n} else {\n  header.modeName = \"後半\";\n}\n\n// mode 1->2\nif (header.mode == 1) {\n  if (players.filter(function(p) {\n      return p.pts >= property.roundTripPoint;\n    }).length >= 1) {\n    header.mode = 2;\n  }\n}\n// mode 2->3\nif (header.mode == 2) {\n  if (players.filter(function(p) {\n      return p.pts <= 0;\n    }).length >= 1) {\n    header.mode = 3;\n  }\n}\n\nif (players.filter(function(p) {\n    return p.status == \"normal\" && p.x === 0\n  }).length === 0) {\n  players.map(function(p) {\n    p.x = 0;\n  });\n  addQCount(players, header, property);\n}\n\n// score\nvar score =\n  players.map(function(p) {\n    return p.name + \":\" + p.pts + \"p\";\n  }).join(\" / \");\nplayers.map(function(p) {\n  p.score = \"\\n\" + score;\n});\n\nangular.forEach(players, function(player, index) {\n  // pinch, chance\n  player.pinch = false;\n  player.chance = player.pts >= 1 && header.mode >= 2 &&\n    players.filter(function(p) {\n      return p.pts >= 2 && p != player;\n    }).length === 0;\n\n  // キーボード入力時の配列の紐付け ローリング等の特殊形式でない場合はこのままでOK\\\n  player.keyIndex = player.position;\n  if (header.pos) {\n    player.line = \"line1\";\n  } else {\n    player.line = \"line2\";\n  }\n});","lines":[{"key":"line1","xType":true,"yType":false,"invisible":false,"zoom":1,"left":0,"right":1,"top":0,"y":0.5,"orderBy":"position"},{"key":"line2","orderBy":"priority","xType":true,"yType":false,"invisible":false,"zoom":1,"left":0,"right":1,"y":0.5}]}