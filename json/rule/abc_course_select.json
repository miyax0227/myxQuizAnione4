{"headers":[{"key":"nowCourse","value":0,"style":"number"}],"items":[{"key":"selected","value":0,"style":"boolean","css":"select"},{"key":"course","value":0,"style":"number"}],"priority":[],"actions":[{"name":"S","css":"action_s","button_css":"btn btn-primary btn-lg","keyArray":"k1","enable0":"return true;","action0":"player.selected = !player.selected;"}],"global_actions":[{"name":"commit","button_css":"btn btn-default","group":"rule","keyboard":"Space","enable0":"return (header.nowCourse > 0);","action0":"// そのコースがまだ決定前の場合\nif (players.filter(function(p) {\n    return p.course == header.nowCourse;\n  }).length === 0) {\n  // 希望者を上位からコース決定\n  var rest = property.capacity;\n  players.filter(function(p) {\n    return p.course === 0 && p.selected;\n  }).map(function(p) {\n    if (rest > 0) {\n      p.course = header.nowCourse;\n      rest--;\n    }\n  });\n  // 不足分を下位から補充\n  if (rest > 0) {\n    players.filter(function(p) {\n      return p.course === 0;\n    }).splice(-rest, rest).map(function(p) {\n      p.course = header.nowCourse;\n    });\n  }\n\n  // そのコースが決定後の場合\n} else {\n  // コース選択を解除\n  players.filter(function(p) {\n    return p.course == header.nowCourse;\n  }).map(function(p) {\n    p.course = 0;\n  });\n}\n\n// 全プレイヤーの選択を解除\nplayers.map(function(p) {\n  p.selected = false;\n});\n"}],"global_actions_repeat":[{"name":"","button_css":"btn btn-default","group":"rule","indexes0":"return property.courseArray;","enable1":"return true;","action1":"header.nowCourse = property.courseName.indexOf(index);"}],"tweet":{},"judgement":"angular.forEach(players.filter(function(item) {\n  /* rankがない人に限定 */\n  return (item.rank === 0);\n}), function(player, i) {\n\n});","calc":"var key = 0;\nangular.forEach(players, function(player, index) {\n  if (player.course === 0) {\n    player.keyIndex = (key++);\n    player.line = \"line2\";\n  } else if (player.course == header.nowCourse) {\n    player.keyIndex = 999;\n    player.line = \"line1\";\n  } else {\n    player.line = \"left\";\n  }\n\n});","lines":[{"key":"line1","xType":true,"yType":false,"invisible":false,"zoom":1,"left":0,"right":1,"top":0,"y":0.4,"orderBy":"position"},{"key":"line2","orderBy":"keyIndex","xType":true,"yType":false,"invisible":false,"zoom":0.5,"left":0,"right":1,"y":0.9}]}